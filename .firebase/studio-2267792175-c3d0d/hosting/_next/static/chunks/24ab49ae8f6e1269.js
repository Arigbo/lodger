(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let r=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>r],31278)},93479,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(4829);let s=t.forwardRef(({className:e,type:t,...s},i)=>(0,r.jsx)("input",{type:t,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:i,...s}));s.displayName="Input",e.s(["Input",()=>s])},15288,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(4829);let s=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));s.displayName="Card";let i=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let n=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));n.displayName="CardTitle";let l=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";let o=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",e),...t}));o.displayName="CardContent";let d=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t}));d.displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>o,"CardDescription",()=>l,"CardFooter",()=>d,"CardHeader",()=>i,"CardTitle",()=>n])},10204,e=>{"use strict";var r=e.i(43476),t=e.i(71645);e.i(74080);var a=e.i(91918),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let i=(0,a.createSlot)(`Primitive.${s}`),n=t.forwardRef((e,t)=>{let{asChild:a,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,r.jsx)(a?i:s,{...n,ref:t})});return n.displayName=`Primitive.${s}`,{...e,[s]:n}},{}),i=t.forwardRef((e,t)=>(0,r.jsx)(s.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));i.displayName="Label";var n=e.i(25913),l=e.i(4829);let o=(0,n.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef(({className:e,...t},a)=>(0,r.jsx)(i,{ref:a,className:(0,l.cn)(o(),e),...t}));d.displayName=i.displayName,e.s(["Label",()=>d],10204)},45301,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(19455),s=e.i(15288),i=e.i(93479),n=e.i(10204),l=e.i(22016),o=e.i(31278),d=e.i(53145),c=e.i(94814),u=e.i(65638),m=e.i(3133);e.i(11981);var f=e.i(31883),p=e.i(57094),x=e.i(50350),h=e.i(61480),g=e.i(74911),v=e.i(18566);e.i(36180);var j=e.i(17875);let w=u.object({email:u.string().email("Please enter a valid email address."),password:u.string().min(1,"Password is required.")});function b({userType:e}){let t=(0,h.useAuth)(),s=(0,h.useFirestore)(),{toast:u}=(0,g.useToast)(),b=(0,v.useRouter)(),y=(0,d.useForm)({resolver:(0,c.zodResolver)(w),defaultValues:{email:"",password:""}}),{isSubmitting:N}=y.formState,C=async(r,t=!1)=>{if(!s)return;let a=(0,j.doc)(s,"users",r);try{let t=null,s=await (0,j.getDoc)(a);if(s.exists())t=s.data();else{let e=sessionStorage.getItem("newUserProfile");if(!e)return void u({variant:"destructive",title:"User Profile Incomplete",description:"Could not find profile data. Please contact support."});(t=JSON.parse(e)).id=r,(0,j.setDoc)(a,t).catch(e=>{let r=new x.FirestorePermissionError({path:a.path,operation:"create",requestResourceData:t});p.errorEmitter.emit("permission-error",r)}),sessionStorage.removeItem("newUserProfile")}if(t?.role&&t.role!==e)return void u({variant:"destructive",title:"Invalid Credentials",description:"The email or password you entered is incorrect. Please check your credentials and try again."});t?.role==="landlord"?b.push("/landlord"):b.push("/student")}catch(e){console.error("Error during login process:",e),e instanceof x.FirestorePermissionError||u({variant:"destructive",title:"Login Error",description:"An unexpected error occurred while fetching your profile."})}},F=async e=>{if(!t)return void u({variant:"destructive",title:"Firebase not initialized."});try{let r=await (0,f.initiateEmailSignIn)(t,e.email,e.password);await C(r.user.uid,!0)}catch(r){console.error("Sign-in error:",r);let e="An unknown error occurred. Please try again.";switch(r.code){case"auth/invalid-email":e="Please enter a valid email address.";break;case"auth/user-disabled":e="This user account has been disabled.";break;case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":e="Invalid email or password. Please try again.";break;default:e=r.message}u({variant:"destructive",title:"Sign In Failed",description:e})}};return(0,r.jsx)(m.Form,{...y,children:(0,r.jsxs)("form",{onSubmit:y.handleSubmit(F),className:"space-y-4",children:[(0,r.jsx)(m.FormField,{control:y.control,name:"email",render:({field:t})=>(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(n.Label,{htmlFor:`${e}-email`,children:"Email"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(i.Input,{id:`${e}-email`,type:"email",placeholder:"name@example.com",...t})}),(0,r.jsx)(m.FormMessage,{})]})}),(0,r.jsx)(m.FormField,{control:y.control,name:"password",render:({field:t})=>(0,r.jsxs)(m.FormItem,{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(n.Label,{htmlFor:`${e}-password`,children:"Password"}),(0,r.jsx)(l.default,{href:"/auth/forgot-password",className:"ml-auto inline-block text-sm underline",children:"Forgot your password?"})]}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(i.Input,{id:`${e}-password`,type:"password",...t})}),(0,r.jsx)(m.FormMessage,{})]})}),(0,r.jsxs)(a.Button,{type:"submit",className:"w-full",disabled:N,children:[N&&(0,r.jsx)(o.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Sign In with Email"]})]})})}function y(){let[e,i]=(0,t.useState)(null);return e?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background px-4",children:(0,r.jsxs)(s.Card,{className:"w-full max-w-md",children:[(0,r.jsxs)(s.CardHeader,{className:"text-center",children:[(0,r.jsx)(s.CardTitle,{className:"font-headline text-3xl",children:"student"===e?"Student Login":"Landlord Login"}),(0,r.jsx)(s.CardDescription,{children:"Sign in to continue to Lodger"})]}),(0,r.jsx)(s.CardContent,{children:(0,r.jsx)(b,{userType:e})}),(0,r.jsxs)(s.CardFooter,{className:"flex-col gap-4",children:[(0,r.jsx)(a.Button,{variant:"ghost",className:"w-full",onClick:()=>i(null),children:"â† Back to account type selection"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Don't have an account?"," ",(0,r.jsx)(l.default,{href:"/auth/signup",className:"font-medium text-primary underline-offset-4 hover:underline",children:"Sign up"})]})]})]})}):(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background px-4",children:(0,r.jsxs)(s.Card,{className:"w-full max-w-md",children:[(0,r.jsxs)(s.CardHeader,{className:"text-center",children:[(0,r.jsx)(s.CardTitle,{className:"font-headline text-3xl",children:"Welcome Back"}),(0,r.jsx)(s.CardDescription,{children:"Select your account type to continue"})]}),(0,r.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,r.jsx)(a.Button,{className:"w-full h-20 text-lg",onClick:()=>i("student"),children:"Sign in as Student"}),(0,r.jsx)(a.Button,{className:"w-full h-20 text-lg",variant:"outline",onClick:()=>i("landlord"),children:"Sign in as Landlord"})]}),(0,r.jsx)(s.CardFooter,{className:"justify-center",children:(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Don't have an account?"," ",(0,r.jsx)(l.default,{href:"/auth/signup",className:"font-medium text-primary underline-offset-4 hover:underline",children:"Sign up"})]})})]})})}e.s(["default",()=>y])}]);