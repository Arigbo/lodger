module.exports=[48060,a=>{"use strict";var b=a.i(87924),c=a.i(31626),d=a.i(72131),e=a.i(50944),f=a.i(91119),g=a.i(99570),h=a.i(5084),i=a.i(86304),j=a.i(14574),k=a.i(72228),l=a.i(67453),m=a.i(40197),n=a.i(1484),o=a.i(89619),p=a.i(73570),q=a.i(71931),r=a.i(90166),s=a.i(63910),t=a.i(96221),u=a.i(23690),v=a.i(54614);a.i(69387);var w=a.i(60574),x=a.i(38246);a.i(79597);var y=a.i(36505),z=a.i(28137),A=a.i(42816);function B(){let a=(0,e.useParams)(),B=Array.isArray(a.id)?a.id[0]:a.id,{user:C,isUserLoading:D}=(0,y.useUser)(),E=(0,y.useFirestore)(),{toast:F}=(0,v.useToast)(),G=(0,y.useMemoFirebase)(()=>B?(0,w.doc)(E,"leaseAgreements",B):null,[E,B]),{data:H,isLoading:I}=(0,z.useDoc)(G),J=(0,y.useMemoFirebase)(()=>H?(0,w.doc)(E,"users",H.landlordId):null,[E,H]),{data:K,isLoading:L}=(0,z.useDoc)(J),M=(0,y.useMemoFirebase)(()=>H?(0,w.doc)(E,"users",H.tenantId):null,[E,H]),{data:N,isLoading:O}=(0,z.useDoc)(M),P=(0,y.useMemoFirebase)(()=>H?(0,w.doc)(E,"properties",H.propertyId):null,[E,H]),{data:Q,isLoading:R}=(0,z.useDoc)(P),[S,T]=(0,d.useState)(!1),[U,V]=(0,d.useState)(!1),W=async()=>{if(G&&H){T(!0);try{let a=K?.legalName||K?.name||"Landlord",b=`

Digitally Signed by Landlord: ${a} on ${new Date().toLocaleString()}`,c=H.leaseText+b;await (0,w.updateDoc)(G,{landlordSigned:!0,leaseText:c}),T(!1),V(!0),F({title:"Lease Signed Successfully!",description:"Your signature has been recorded."})}catch(a){console.error("Error signing lease:",a),T(!1),F({variant:"destructive",title:"Error",description:"Could not sign the lease. Please try again."})}}};return(console.log("Lease Detail Debug:",{id:B,isUserLoading:D,isLeaseLoading:I,currentUserUid:C?.uid,leaseExists:!!H,leaseLandlordId:H?.landlordId,match:C&&H?C.uid===H.landlordId:"N/A"}),D||I)?(0,b.jsx)(A.default,{}):H&&C&&C.uid===H.landlordId?L||O||R?(0,b.jsx)(A.default,{}):(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 max-w-5xl mx-auto space-y-12 pb-32 animate-in fade-in duration-700",children:[(0,b.jsx)(c.default,{id:"507dd19b50be8125",children:"@media print{@page{margin:2cm}body *{visibility:hidden}#lease-document,#lease-document *{visibility:visible}#lease-document{width:100%;position:absolute;top:0;left:0}}"}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 flex flex-col md:flex-row md:items-end justify-between gap-8 pb-8 border-b-4 border-foreground/5",children:[(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 space-y-4",children:[(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 "+((0,u.cn)("p-2 rounded-xl bg-white shadow-lg border-2","active"===H.status?"border-green-500/20":"pending"===H.status?"border-primary/20":"border-muted/20")||""),children:(a=>{switch(a){case"active":return(0,b.jsx)(l.CheckCircle2,{className:"h-5 w-5 text-green-600"});case"expired":return(0,b.jsx)(m.FileClock,{className:"h-5 w-5 text-muted-foreground"});case"pending":return(0,b.jsx)(n.Hourglass,{className:"h-5 w-5 text-primary"});case"terminating":return(0,b.jsx)(p.AlertTriangle,{className:"h-5 w-5 text-destructive"})}})(H.status)}),(0,b.jsx)(i.Badge,{variant:(a=>{switch(a){case"active":return"secondary";case"expired":return"outline";case"pending":return"default";case"terminating":return"destructive"}})(H.status),className:"px-4 py-1 rounded-full text-[10px] font-black uppercase tracking-widest",children:H.status})]}),(0,b.jsx)("h1",{className:"jsx-507dd19b50be8125 font-headline text-4xl md:text-5xl font-black tracking-tight text-foreground uppercase",children:"LEASE AGREEMENT"}),(0,b.jsxs)("p",{className:"jsx-507dd19b50be8125 text-lg text-muted-foreground font-medium",children:["Digital Contract for ",(0,b.jsxs)(x.default,{href:`/landlord/properties/${Q?.id}`,className:"text-primary hover:underline",children:["#",Q?.title]})]})]}),(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 flex flex-wrap gap-3",children:(0,b.jsxs)(g.Button,{variant:"outline",className:"h-14 rounded-2xl px-6 font-black text-xs uppercase tracking-widest gap-2 bg-white hover:bg-muted/50 transition-all border-2",onClick:()=>window.print(),children:[(0,b.jsx)(q.Printer,{className:"h-4 w-4"})," PRINT"]})})]}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 grid grid-cols-1 lg:grid-cols-3 gap-10",children:[(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 lg:col-span-2 space-y-10",children:(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 relative group",children:[(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 absolute inset-0 bg-muted/20 -rotate-1 rounded-[3rem] -z-10 transition-transform group-hover:rotate-0"}),(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 absolute inset-0 bg-primary/5 rotate-1 rounded-[3rem] -z-10 transition-transform group-hover:rotate-0"}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 relative bg-white border-2 border-foreground/5 shadow-2xl rounded-[3rem] p-8 md:p-12 min-h-[600px] flex flex-col",children:[(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 flex justify-between items-start mb-12",children:[(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 space-y-1",children:[(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-[10px] font-black text-muted-foreground/40 uppercase tracking-[0.2em]",children:"DOCUMENT ID"}),(0,b.jsxs)("p",{className:"jsx-507dd19b50be8125 font-mono text-[10px] opacity-60",children:["#",H.id.toUpperCase()]})]}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 text-right",children:[(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-[10px] font-black text-muted-foreground/40 uppercase tracking-[0.2em]",children:"ISSUE DATE"}),(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 font-bold text-sm",children:(0,k.format)(new Date(H.startDate),"MMMM dd, yyyy")})]})]}),(0,b.jsx)(h.Separator,{className:"mb-10 opacity-10"}),(0,b.jsx)("h2",{className:"jsx-507dd19b50be8125 text-xl font-black uppercase tracking-widest mb-8 text-center decoration-primary/20 underline underline-offset-8 decoration-4",children:"CONTRACTUAL TERMS & CONDITIONS"}),(0,b.jsx)("div",{id:"lease-document",className:"jsx-507dd19b50be8125 prose prose-sm md:prose-base max-w-none whitespace-pre-wrap leading-relaxed text-foreground/80 flex-grow",children:H.leaseText}),(0,b.jsx)(h.Separator,{className:"my-12 opacity-10"}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 grid grid-cols-1 md:grid-cols-2 gap-12 mt-auto pt-8 border-t-2 border-dotted border-muted/30",children:[(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 space-y-4",children:[(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-[10px] font-black text-muted-foreground/60 uppercase tracking-widest",children:"LANDLORD SIGNATURE"}),(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 h-24 bg-muted/10 rounded-3xl border-2 border-dashed border-muted/30 flex items-center justify-center relative overflow-hidden",children:H.landlordSigned?(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 text-center animate-in zoom-in duration-500",children:[(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-2xl text-primary font-bold opacity-80 -rotate-3",children:K?.name}),(0,b.jsx)(i.Badge,{variant:"secondary",className:"mt-2 text-[9px] font-black uppercase tracking-tighter bg-green-500/10 text-green-600 border-none",children:"VERIFIED SIGNATURE"})]}):(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 flex flex-col items-center gap-1 opacity-20",children:[(0,b.jsx)(n.Hourglass,{className:"h-6 w-6"}),(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-[8px] font-black uppercase tracking-widest",children:"AWAITING EXECUTION"})]})}),(0,b.jsxs)("p",{className:"jsx-507dd19b50be8125 text-center text-xs font-bold text-muted-foreground/40",children:["Executed by: ",K?.name||"Authorized Representative"]})]}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 space-y-4",children:[(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-[10px] font-black text-muted-foreground/60 uppercase tracking-widest",children:"TENANT SIGNATURE"}),(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 h-24 bg-muted/10 rounded-3xl border-2 border-dashed border-muted/30 flex items-center justify-center relative overflow-hidden",children:H.tenantSigned?(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 text-center animate-in zoom-in duration-500",children:[(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-2xl text-primary font-bold opacity-80 -rotate-3",children:N?.name}),(0,b.jsx)(i.Badge,{variant:"secondary",className:"mt-2 text-[9px] font-black uppercase tracking-tighter bg-green-500/10 text-green-600 border-none",children:"VERIFIED SIGNATURE"})]}):(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 flex flex-col items-center gap-1 opacity-20",children:[(0,b.jsx)(n.Hourglass,{className:"h-6 w-6"}),(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-[8px] font-black uppercase tracking-widest",children:"PENDING APPROVAL"})]})}),(0,b.jsxs)("p",{className:"jsx-507dd19b50be8125 text-center text-xs font-bold text-muted-foreground/40",children:["Executed by: ",N?.name||"Prospective Tenant"]})]})]})]})]})}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 space-y-10",children:[(0,b.jsxs)(f.Card,{className:"rounded-[2.5rem] border-2 border-foreground/5 shadow-xl bg-white overflow-hidden",children:[(0,b.jsx)(f.CardHeader,{className:"bg-primary/5 border-b-2 border-primary/10",children:(0,b.jsxs)(f.CardTitle,{className:"text-xs font-black uppercase tracking-widest flex items-center gap-2",children:[(0,b.jsx)(l.CheckCircle2,{className:"h-4 w-4"})," CONTRACT METRICS"]})}),(0,b.jsx)(f.CardContent,{className:"p-8 space-y-8",children:(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 space-y-6",children:[(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 flex justify-between items-center group",children:[(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125",children:[(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-[10px] font-black text-muted-foreground/40 uppercase tracking-widest mb-1",children:"RENTAL ASSET"}),(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 font-black text-sm uppercase group-hover:text-primary transition-colors truncate max-w-[150px]",children:Q?.title})]}),(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 h-10 w-10 rounded-xl bg-muted/20 flex items-center justify-center",children:(0,b.jsx)(s.Building,{className:"h-5 w-5 opacity-20"})})]}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 flex justify-between items-center group",children:[(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125",children:[(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-[10px] font-black text-muted-foreground/40 uppercase tracking-widest mb-1",children:"TERM DURATION"}),(0,b.jsxs)("p",{className:"jsx-507dd19b50be8125 font-black text-sm uppercase truncate max-w-[150px]",children:[(0,k.format)(new Date(H.startDate),"MMM yy")," - ",(0,k.format)(new Date(H.endDate),"MMM yy")]})]}),(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 h-10 w-10 rounded-xl bg-muted/20 flex items-center justify-center",children:(0,b.jsx)(m.FileClock,{className:"h-5 w-5 opacity-20"})})]}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 flex justify-between items-center group",children:[(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125",children:[(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-[10px] font-black text-muted-foreground/40 uppercase tracking-widest mb-1",children:"MONTHLY RATE"}),(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 font-black text-2xl text-primary",children:(0,u.formatPrice)(Q?.price||0,Q?.currency)})]}),(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 h-10 w-10 rounded-xl bg-green-500/10 flex items-center justify-center",children:(0,b.jsx)(r.DollarSign,{className:"h-5 w-5 text-green-600"})})]})]})})]}),"pending"===H.status&&!H.landlordSigned&&(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 relative group overflow-hidden rounded-[2.5rem] bg-foreground text-white p-8 md:p-10 shadow-2xl space-y-8 animate-in slide-in-from-right duration-700",children:[(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-bl-[5rem] -mr-8 -mt-8 transition-all group-hover:scale-110"}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 relative z-10 space-y-4 text-center",children:[(0,b.jsx)("h3",{className:"jsx-507dd19b50be8125 text-2xl font-black uppercase tracking-tight",children:"EXECUTE AGREEMENT"}),(0,b.jsx)("p",{className:"jsx-507dd19b50be8125 text-white/60 font-serif text-sm leading-relaxed",children:'"Your signature confirm that terms reflect the latest property updates."'}),(0,b.jsx)(g.Button,{className:"w-full h-16 rounded-2xl bg-white text-foreground hover:bg-white/90 font-black text-sm uppercase tracking-widest gap-3 shadow-2xl transition-all hover:scale-105 active:scale-95 disabled:scale-100 disabled:opacity-70",onClick:W,disabled:S,children:S?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.Loader2,{className:"h-5 w-5 animate-spin"})," SIGNING..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Signature,{className:"h-5 w-5"})," SIGN DIGITALLY"]})})]})]}),"pending"===H.status&&H.landlordSigned&&(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 relative group overflow-hidden rounded-[2.5rem] bg-blue-600 text-white p-8 md:p-10 shadow-2xl space-y-8 animate-in slide-in-from-right duration-700 text-center",children:[(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-bl-[5rem] -mr-8 -mt-8 transition-all group-hover:scale-110"}),(0,b.jsxs)("div",{className:"jsx-507dd19b50be8125 relative z-10 space-y-4",children:[(0,b.jsx)("h3",{className:"jsx-507dd19b50be8125 text-xl font-black uppercase tracking-tight",children:"AWAITING TENANT"}),(0,b.jsxs)("p",{className:"jsx-507dd19b50be8125 text-white/60 font-serif text-sm leading-relaxed",children:["This lease has been sent to ",N?.name," for their signature."]})]})]}),(0,b.jsx)(x.default,{href:"/landlord/leases",className:(0,u.cn)((0,g.buttonVariants)({variant:"ghost"}),"font-black text-[10px] uppercase tracking-[0.3em] hover:tracking-[0.4em] transition-all opacity-40 hover:opacity-100"),children:"â† BACK TO ALL LEASES"})]})]}),(0,b.jsx)(j.Dialog,{open:U,onOpenChange:V,children:(0,b.jsxs)(j.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsxs)(j.DialogTitle,{className:"flex items-center gap-2 text-green-600",children:[(0,b.jsx)(l.CheckCircle2,{className:"h-6 w-6"}),"Lease Signed Successfully"]}),(0,b.jsx)(j.DialogDescription,{children:"Your digital signature has been recorded. The lease is now pending tenant signature."})]}),(0,b.jsx)("div",{className:"jsx-507dd19b50be8125 flex justify-center py-6",children:(0,b.jsx)(o.Signature,{className:"h-16 w-16 text-primary/20"})}),(0,b.jsx)(j.DialogFooter,{className:"sm:justify-between gap-2",children:(0,b.jsx)(g.Button,{className:"w-full",onClick:()=>V(!1),children:"Okay, Got it"})})]})})]}):(console.warn("Landlord Lease not found or access denied",{leaseId:B,leaseExists:!!H,currentUserId:C?.uid,leaseLandlordId:H?.landlordId}),(0,b.jsx)("div",{className:"container mx-auto max-w-2xl py-20 px-4 text-center",children:(0,b.jsxs)("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-8",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-destructive mb-4",children:"Unable to Load Lease"}),(0,b.jsx)("p",{className:"mb-6 text-muted-foreground",children:"We couldn't display this lease agreement. Here is the diagnostic info to help us fix it:"}),(0,b.jsxs)("div",{className:"text-left bg-black/80 text-green-400 p-4 rounded-md font-mono text-xs overflow-auto mb-6",children:[(0,b.jsxs)("p",{children:["Lease ID in URL: ",B]}),(0,b.jsxs)("p",{children:["Lease Document Found: ",H?"YES":"NO"]}),(0,b.jsxs)("p",{children:["User Logged In: ",C?"YES":"NO"]}),C&&H&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("p",{children:["Your User ID: ",C.uid]}),(0,b.jsxs)("p",{children:["Lease Landlord ID: ",H.landlordId||"MISSING"]}),(0,b.jsxs)("p",{children:["Match: ",C.uid===H.landlordId?"YES":"FAIL"]})]}),H&&!H.landlordId&&(0,b.jsx)("p",{className:"mt-2 text-red-500 font-bold",children:"CRITICAL: This lease agreement document has no landlordId field!"}),!H&&(0,b.jsx)("p",{className:"mt-2 text-amber-400",children:"Note: If Found is NO, the ID might be wrong or the document was deleted. Database collection checked: 'leaseAgreements'"}),H&&C&&H.landlordId&&C.uid!==H.landlordId&&(0,b.jsx)("p",{className:"mt-2 text-amber-400",children:"Note: Match is FAIL, which means you are logged in but don't own this lease."})]}),(0,b.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,b.jsx)(g.Button,{asChild:!0,variant:"outline",className:"rounded-xl",children:(0,b.jsx)(x.default,{href:"/landlord/leases",children:"Return to Leases"})}),(0,b.jsx)(g.Button,{variant:"default",className:"rounded-xl",onClick:()=>window.location.reload(),children:"Retry / Force Refresh"})]})]})}))}a.s(["default",()=>B])}];

//# sourceMappingURL=src_app_landlord_leases_%5Bid%5D_page_tsx_58b6c45a._.js.map